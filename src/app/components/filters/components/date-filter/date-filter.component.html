<form [formGroup]="form">
  <fieldset class="overflow-auto">
    <legend class="w-full px-2 pt-2">
      <div class="dropdown-header">
        <p class="me-4">
          @if (title?.icon) {
          <i class="fa-fw {{ title?.icon }}"></i>
          }

          {{ title?.label }}
        </p>

        <div class="ms-4">
          @if (hasFilter()) {
          <button
            type="button"
            class="me-2"
            title="Clear filters"
            (click)="clearFilters()"
            (keydown.enter)="clearFilters()"
          >
            <i class="fa-fw far fa-filter-circle-xmark"></i>
          </button>
          }

          <button
            type="button"
            title="Apply filters"
            [ngClass]="{ 'ms-7': !hasFilter() }"
            (click)="submit()"
            (keydown.enter)="submit()"
          >
            <i class="fa-fw far fa-filter"></i>
          </button>
        </div>
      </div>
    </legend>

    <ul class="data-list pt-2">
      @for (option of dateOptions(); track $index) {
      <li
        class="data-list-item flex text-sm px-2 leading-7"
        [ngClass]="{'selected': form.get('option')?.value === option.code}"
      >
        <input
          #radio
          type="radio"
          formControlName="option"
          id="date-filter-{{ option.code }}"
          value="{{ option.code }}"
        />

        <span
          class="fa-fw radio me-1 p-1 cursor-pointer"
          (click)="radio.click()"
          (keydown.enter)="radio.click()"
          tabindex="-1"
        ></span>

        @if (option.code !== 'custom-range') {
        <label
          for="date-filter-{{ option.code }}"
          class="p-1 grow cursor-pointer"
        >
          {{ option.label }}
        </label>
        } @else {
        <div
          class="p-1 grow grid grid-cols-[4rem_auto] *:cursor-pointer"
          formGroupName="customRange"
        >
          <label for="date-filter-custom-from">From</label>
          <input class="border-b border-gray-300"
            type="date"
            id="date-filter-custom-from"
            formControlName="from"
            [max]="form.get('customRange.to')?.value ?? today"
            (click)="forceFilterToCustomRange()"
          />

          <label for="date-filter-custom-to">To</label>
          <input class="border-b border-gray-300"
            type="date"
            id="date-filter-custom-to"
            formControlName="to"
            [min]="form.get('customRange.from')?.value"
            [max]="today"
            (click)="forceFilterToCustomRange()"
          />
        </div>
        }
      </li>
      }
    </ul>
  </fieldset>
</form>
