<ul class="divide-y">
  @for (filter of filterDropdowns(); track filter.aggregation.column) {
    <li class="collapse mb-1 bg-base-200">
      <!-- header -->
      <input
        class="w-full"
        role="button"
        type="radio"
        name="more-filters"
        [attr.title]="'filters.openFilter' | transloco: { filter: filter.label }"
        [attr.aria-label]="'filters.openFilter' | transloco: { filter: filter.label }"
      />

      <div class="collapse-title dropdown-header p-2 flex gap-1 items-baseline justify-between"
        [class.applied-filters]="hasAppliedFilters()[$index]">
        <!-- aggregation's icon -->
        <i class="fa-fw {{ filter.icon || 'fas fa-list' }} me-1"></i>

        <!-- aggregation label -->
        <span class="me-4 grow items-baseline">{{ filter.label }}</span>

        <!-- actions buttons -->
        <div class="flex gap-2 z-10">
            @if (filter?.moreFiltersCount) {
            <span class="ms-2 size-5 pill pill-xs bg-primary text-white flex place-content-center font-semibold">
              {{ filter.moreFiltersCount }}
            </span>
          }
          @if (hasAppliedFilters()[$index]) {
            <button
              [attr.title]="'filters.clearFilters' | transloco"
              [attr.aria-label]="'filters.clearFilters' | transloco"
              (click)="clearFilter($index)"
              (keydown.enter)="clearFilter($index)"
            >
              <i class="fa-fw far fa-filter-circle-xmark"></i>
            </button>
          }

          @if (hasFilters()[$index]) {

            <button
              [attr.title]="'filtrs.applyFilters' | transloco"
              [attr.aria-label]="'filters.applyFilters' | transloco"
              (click)="applyFilter($index)"
              (keydown.enter)="applyFilter($index)"
            >
              <i class="fa-fw far fa-filter"></i>
            </button>
          }
        </div>
      </div>

      <!-- content -->
      <app-aggregation
        class="collapse-content"
        [aggregation]="filter.aggregation"
        (onSelect)="updateHasFilters($event, $index)"
        (onLoadMore)="loadMore(filter.aggregation, $index)"
      />
    </li>
  }
  @empty {
    <li class="p-2 text-center">
      {{ 'filters.noFiltersAvailable' | transloco }}
    </li>
  }
</ul>